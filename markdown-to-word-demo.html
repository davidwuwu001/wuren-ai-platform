<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown è½¬ Word ç¤ºä¾‹</title>
    <!-- æ·»åŠ faviconï¼Œé¿å…404é”™è¯¯ -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ“„</text></svg>">
    <!-- æ·»åŠ  markdown è§£æåº“ -->
    <script src="https://cdn.bootcdn.net/ajax/libs/marked/4.0.0/marked.min.js"></script>
    <!-- æ·»åŠ ä»£ç é«˜äº®åº“ -->
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.3.1/styles/github.min.css">
    <script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.3.1/highlight.min.js"></script>
    <!-- æ·»åŠ docx.jsç”¨äºç”ŸæˆWordæ–‡æ¡£ -->
    <script src="docx.js"></script>
    <!-- æ·»åŠ FileSaver.jsç”¨äºä¿å­˜æ–‡ä»¶ -->
    <script src="FileSaver.min.js"></script>
    <!-- å¼•å…¥æˆ‘ä»¬åˆ›å»ºçš„markdown-to-word.js -->
    <script src="markdown-to-word.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        h1 {
            color: #6200ee;
            text-align: center;
            margin-bottom: 30px;
        }
        h2 {
            color: #3700b3;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
            margin-top: 30px;
        }
        .container {
            display: flex;
            gap: 20px;
        }
        .input-section, .preview-section {
            flex: 1;
        }
        textarea {
            width: 100%;
            height: 400px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .preview {
            width: 100%;
            height: 400px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            overflow: auto;
        }
        button {
            background-color: #6200ee;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 0;
        }
        button:hover {
            background-color: #3700b3;
        }
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        code {
            background-color: #f5f5f5;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: Consolas, Monaco, 'Andale Mono', monospace;
        }
        pre {
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
        pre code {
            background-color: transparent;
            padding: 0;
        }
        .word-btn {
            background-color: #2e7d32;
        }
        .word-btn:hover {
            background-color: #1b5e20;
        }
    </style>
</head>
<body>
    <h1>Markdown è½¬ Word ç¤ºä¾‹</h1>
    
    <div class="controls">
        <button id="load-sample">åŠ è½½ç¤ºä¾‹å†…å®¹</button>
        <button id="export-word" class="word-btn">å¯¼å‡ºä¸ºWordæ–‡æ¡£</button>
    </div>
    
    <div class="container">
        <div class="input-section">
            <h2>Markdown è¾“å…¥</h2>
            <textarea id="markdown-input" placeholder="åœ¨è¿™é‡Œè¾“å…¥Markdownæ ¼å¼çš„æ–‡æœ¬..."></textarea>
        </div>
        <div class="preview-section">
            <h2>é¢„è§ˆæ•ˆæœ</h2>
            <div id="markdown-preview" class="preview"></div>
        </div>
    </div>
    
    <h2>ä½¿ç”¨è¯´æ˜</h2>
    <p>1. åœ¨å·¦ä¾§è¾“å…¥æ¡†ä¸­è¾“å…¥Markdownæ ¼å¼çš„æ–‡æœ¬</p>
    <p>2. å³ä¾§ä¼šå®æ—¶æ˜¾ç¤ºæ¸²æŸ“åçš„æ•ˆæœ</p>
    <p>3. ç‚¹å‡»"å¯¼å‡ºä¸ºWordæ–‡æ¡£"æŒ‰é’®å°†å†…å®¹å¯¼å‡ºä¸ºWordæ–‡æ¡£</p>
    <p>4. æ‚¨ä¹Ÿå¯ä»¥ç‚¹å‡»"åŠ è½½ç¤ºä¾‹å†…å®¹"æŒ‰é’®æ¥æŸ¥çœ‹æ¼”ç¤º</p>
    
    <h2>å¦‚ä½•åœ¨æ‚¨çš„é¡¹ç›®ä¸­ä½¿ç”¨</h2>
    <p>åªéœ€è¦åœ¨æ‚¨çš„HTMLä¸­å¼•å…¥ä»¥ä¸‹ä¸‰ä¸ªæ–‡ä»¶ï¼š</p>
    <pre><code>&lt;script src="docx.js"&gt;&lt;/script&gt;
&lt;script src="FileSaver.min.js"&gt;&lt;/script&gt;
&lt;script src="markdown-to-word.js"&gt;&lt;/script&gt;</code></pre>
    
    <p>ç„¶åä½¿ç”¨ä»¥ä¸‹JavaScriptä»£ç å¯¼å‡ºWordï¼š</p>
    <pre><code>// è½¬æ¢Markdownä¸ºWordå¹¶ä¸‹è½½
window.MarkdownToWord.convert(markdownText, 'æ–‡ä»¶å');

// æˆ–è€…åˆ›å»ºä¸€ä¸ªå¯¼å‡ºæŒ‰é’®
const button = window.MarkdownToWord.createButton(
    containerElement, 
    markdownText, 
    'æ–‡ä»¶å'
);</code></pre>

    <script>
        // ç¤ºä¾‹Markdownæ–‡æœ¬
        const sampleMarkdown = `# Markdownç¤ºä¾‹æ–‡æ¡£

## ä»‹ç»

è¿™æ˜¯ä¸€ä¸ª**Markdown**æ ¼å¼çš„ç¤ºä¾‹æ–‡æ¡£ï¼Œç”¨äºå±•ç¤º*Markdownè½¬Word*åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- æ”¯æŒ**ç²—ä½“**ã€*æ–œä½“*ç­‰æ ·å¼
- æ”¯æŒå¤šçº§æ ‡é¢˜ï¼ˆ# ## ### ####ï¼‰
- æ”¯æŒæ— åºåˆ—è¡¨
- æ”¯æŒä»£ç å—

## ä»£ç ç¤ºä¾‹

è¿™æ˜¯ä¸€æ®µè¡Œå†…ä»£ç  \`const x = 1;\`

ä¸‹é¢æ˜¯ä¸€ä¸ªä»£ç å—ï¼š

\`\`\`javascript
function hello() {
  console.log("Hello, World!");
  return true;
}
\`\`\`

## æ€»ç»“

é€šè¿‡è¿™ä¸ªç¤ºä¾‹ï¼Œæˆ‘ä»¬æ¼”ç¤ºäº†å¦‚ä½•å°†Markdownæ–‡æœ¬è½¬æ¢ä¸ºWordæ–‡æ¡£ï¼Œå¹¶ä¿ç•™åŸå§‹çš„æ ¼å¼å’Œæ ·å¼ã€‚`;

        // DOMå…ƒç´ 
        const markdownInput = document.getElementById('markdown-input');
        const markdownPreview = document.getElementById('markdown-preview');
        const loadSampleBtn = document.getElementById('load-sample');
        const exportWordBtn = document.getElementById('export-word');
        
        // æ›´æ–°é¢„è§ˆ
        function updatePreview() {
            const markdown = markdownInput.value;
            markdownPreview.innerHTML = marked.parse(markdown);
            
            // åº”ç”¨ä»£ç é«˜äº®
            document.querySelectorAll('pre code').forEach((block) => {
                hljs.highlightBlock(block);
            });
        }
        
        // åŠ è½½ç¤ºä¾‹å†…å®¹
        loadSampleBtn.addEventListener('click', () => {
            markdownInput.value = sampleMarkdown;
            updatePreview();
        });
        
        // å¯¼å‡ºWordæ–‡æ¡£
        exportWordBtn.addEventListener('click', () => {
            const markdown = markdownInput.value;
            if (!markdown.trim()) {
                alert('è¯·å…ˆè¾“å…¥ä¸€äº›Markdownæ–‡æœ¬');
                return;
            }
            
            // ä½¿ç”¨æˆ‘ä»¬çš„MarkdownToWordåº“å¯¼å‡ºWord
            window.MarkdownToWord.convert(markdown, 'Markdownç¤ºä¾‹');
        });
        
        // å®æ—¶æ›´æ–°é¢„è§ˆ
        markdownInput.addEventListener('input', updatePreview);
        
        // åˆå§‹åŠ è½½ç¤ºä¾‹
        markdownInput.value = sampleMarkdown;
        updatePreview();
    </script>
</body>
</html> 